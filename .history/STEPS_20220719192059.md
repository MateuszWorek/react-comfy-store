## REACT-ROUTER-DOM v5

- pages/index.js

```js
import Home from './HomePage';
import Products from './ProductsPage';
import SingleProduct from './SingleProductPage';
import About from './AboutPage';
import Cart from './CartPage';
import Error from './ErrorPage';
import Checkout from './CheckoutPage';
import PrivateRoute from './PrivateRoute';

export {
  Home,
  Products,
  SingleProduct,
  About,
  Cart,
  Error,
  Checkout,
  PrivateRoute,
};
```

- App.js

```js
import React from 'react';
import { BrowserRouter as Router, Switch, Route } from 'react-router-dom';
import { Navbar, Sidebar, Footer } from './components';
import {
  Home,
  SingleProduct,
  Cart,
  Checkout,
  Error,
  About,
  Products,
  PrivateRoute,
} from './pages';

function App() {
  return (
    <Router>
      <Navbar />
      <Sidebar />
      <Switch>
        <Route exact path='/'>
          <Home />
        </Route>
        <Route exact path='/about'>
          <About />
        </Route>
        <Route exact path='cart'>
          <Cart />
        </Route>
        <Route exact path='/products'>
          <Products />
        </Route>
        <Route exact path='/products/:id' children={<SingleProduct />} />
        <Route exact path='/checkout'>
          <Checkout />
        </Route>
        <Route exact path='*'>
          <Error />
        </Route>
      </Switch>
      <Footer />
    </Router>
  );
}

export default App;
```

## NAVBAR

- components/Navbar.js

```js
import logo from '../assets/logo.svg';
import { FaBars } from 'react-icons/fa';
import { Link } from 'react-router-dom';
import { links } from '../utils/constants';
import CartButtons from './CartButtons';
import { useProductsContext } from '../context/products_context';
import { useUserContext } from '../context/user_context';

const Nav = () => {
  return (
    <NavContainer>
      <div className='nav-center'>
        <div className='nav-header'>
          <Link to='/'>
            <img src={logo} alt='comfy sloth' />
          </Link>
          <button type='buttton' className='nav-toggle'>
            <FaBars />
          </button>
        </div>
        <ul className='nav-links'>
          {links.map((link) => {
            const { id, text, url } = link;
            return (
              <li key={id}>
                <Link to={url}>{text}</Link>
              </li>
            );
          })}
        </ul>
      </div>
    </NavContainer>
  );
};
```

## CARTBUTTONS

- components/CartButtons

```js
import { FaShoppingCart, FaUserMinus, FaUserPlus } from 'react-icons/fa';
import { Link } from 'react-router-dom';
import styled from 'styled-components';
import { useProductsContext } from '../context/products_context';
import { useCartContext } from '../context/cart_context';
import { useUserContext } from '../context/user_context';

const CartButtons = () => {
  return (
    <Wrapper className='cart-btn-wrapper'>
      <Link to='/cart' className='cart-btn'>
        Cart{' '}
        <span className='cart-container'>
          <FaShoppingCart />
          <span className='cart-value'>12</span>
        </span>
      </Link>
      <button type='button' className='auth-btn'>
        Login <FaUserPlus />
      </button>
    </Wrapper>
  );
};
```

## FOOTER

- components/Footer.js

```js
const Footer = () => {
  return (
    <Wrapper>
      <h5>
        &copy; {new Date().getFullYear()}
        <span> ComfySloth</span>
      </h5>
      <h5>All rights reserved</h5>
    </Wrapper>
  );
};
```

## SIDEBAR

- components/Sidebar.js

```js
import logo from '../assets/logo.svg';
import { Link } from 'react-router-dom';
import { useProductsContext } from '../context/products_context';
import { FaTimes } from 'react-icons/fa';
import { links } from '../utils/constants';
import styled from 'styled-components';
import CartButtons from './CartButtons';
import { useUserContext } from '../context/user_context';

const Sidebar = () => {
  const isOpen = false;
  return (
    <SidebarContainer>
      <aside className={`${isOpen ? 'sidebar show-sidebar' : 'sidebar'}`}>
        <div className='sidebar-header'>
          <img src={logo} className='logo' alt='comfy sloth' />
          <button type='button' className='close-btn'>
            <FaTimes />
          </button>
        </div>
        <ul className='links'>
          {links.map(({ id, text, url }) => {
            return (
              <li key={id}>
                <Link to={url}>{text}</Link>
              </li>
            );
          })}
          <li>
            <Link to='checkout'>checkout</Link>
          </li>
        </ul>
        <CartButtons />
      </aside>
    </SidebarContainer>
  );
};
```

## PRODUCTS CONTEXT SETUP

- index.js

```js
import { ProductsProvider } from './context/products_context';
import { FilterProvider } from './context/filter_context';
import { CartProvider } from './context/cart_context';
import { UserProvider } from './context/user_context';
import { Auth0Provider } from '@auth0/auth0-react';

ReactDOM.render(
  <ProductsProvider>
    <App />
  </ProductsProvider>,
  document.getElementById('root')
```

- context/products_context.js

```js
import axios from 'axios';
import React, { useContext, useEffect, useReducer } from 'react';
import reducer from '../reducers/products_reducer';
import { products_url as url } from '../utils/constants';
import {
  SIDEBAR_OPEN,
  SIDEBAR_CLOSE,
  GET_PRODUCTS_BEGIN,
  GET_PRODUCTS_SUCCESS,
  GET_PRODUCTS_ERROR,
  GET_SINGLE_PRODUCT_BEGIN,
  GET_SINGLE_PRODUCT_SUCCESS,
  GET_SINGLE_PRODUCT_ERROR,
} from '../actions';

const initialState = {
  isSidebarOpen: false,
};

const ProductsContext = React.createContext();

export const ProductsProvider = ({ children }) => {
  const [state, dispatch] = useReducer(reducer, initialState);
  const openSidebar = () => {
    // dispatch({ type: 'SIDEBAR_OPEN' });
    dispatch({ type: SIDEBAR_OPEN });
  };
  const closeSidebar = () => {
    // dispatch({ type: 'SIDEBAR_CLOSE' });
    dispatch({ type: SIDEBAR_CLOSE });
  };

  // useEffect(() => {
  //   openSidebar();
  // }, []);

  return (
    // <ProductsContext.Provider value='products context'>
    //   {children}
    // </ProductsContext.Provider>
    <ProductsContext.Provider value={{ ...state, openSidebar, closeSidebar }}>
      {children}
    </ProductsContext.Provider>
  );
};
// make sure use
export const useProductsContext = () => {
  return useContext(ProductsContext);
};
```

- reducers/products_reducer.js

```js
import {
  SIDEBAR_OPEN,
  SIDEBAR_CLOSE,
  GET_PRODUCTS_BEGIN,
  GET_PRODUCTS_SUCCESS,
  GET_PRODUCTS_ERROR,
  GET_SINGLE_PRODUCT_BEGIN,
  GET_SINGLE_PRODUCT_SUCCESS,
  GET_SINGLE_PRODUCT_ERROR,
} from '../actions';

const products_reducer = (state, action) => {
  if (action.type === SIDEBAR_OPEN) {
    // console.log(state);
    return { ...state, isSidebarOpen: true };
  }
  if (action.type === SIDEBAR_CLOSE) {
    // console.log(state);
    return { ...state, isSidebarOpen: false };
  }
  return state;
  throw new Error(`No Matching "${action.type}" - action type`);
};

export default products_reducer;
```

- components/Sidebar.js

```js
const Sidebar = () => {
  const data = useProductsContext();
  console.log(data);
  const isOpen = false;
  return (
    <SidebarContainer>
      <aside className={`${isOpen ? 'sidebar show-sidebar' : 'sidebar'}`}>
        <div className='sidebar-header'>
          <img src={logo} className='logo' alt='comfy sloth' />
          <button type='button' className='close-btn'>
            <FaTimes />
          </button>
        </div>
        <ul className='links'>
          {links.map(({ id, text, url }) => {
            return (
              <li key={id}>
                <Link to={url}>{text}</Link>
              </li>
            );
          })}
          <li>
            <Link to='checkout'>checkout</Link>
          </li>
        </ul>
        <CartButtons />
      </aside>
    </SidebarContainer>
  );
};
```

## SIDEBAR TOGGLE

- components/Sidebar.js

```js
import { useProductsContext } from '../context/products_context';
import { FaTimes } from 'react-icons/fa';
import { links } from '../utils/constants';
import styled from 'styled-components';
import CartButtons from './CartButtons';
import { useUserContext } from '../context/user_context';

const Sidebar = () => {
  const { isSidebarOpen, closeSidebar } = useProductsContext();

  return (
    <SidebarContainer>
      <aside
        className={`${isSidebarOpen ? 'sidebar show-sidebar' : 'sidebar'}`}
      >
        <div className='sidebar-header'>
          <img src={logo} className='logo' alt='comfy sloth' />
          <button type='button' className='close-btn' onClick={closeSidebar}>
            <FaTimes />
          </button>
        </div>
        <ul className='links'>
          {links.map(({ id, text, url }) => {
            return (
              <li key={id}>
                <Link to={url} onClick={closeSidebar}>
                  {text}
                </Link>
              </li>
            );
          })}
          <li>
            <Link to='checkout' onClick={closeSidebar}>
              checkout
            </Link>
          </li>
        </ul>
        <CartButtons />
      </aside>
    </SidebarContainer>
  );
};
```

- components/CartButtons.js

```js
import { useProductsContext } from '../context/products_context';
import { useCartContext } from '../context/cart_context';
import { useUserContext } from '../context/user_context';

const CartButtons = () => {
  const { closeSidebar } = useProductsContext();

  return (
    <Wrapper className='cart-btn-wrapper'>
      <Link to='/cart' className='cart-btn' onClick={closeSidebar}>
        Cart{' '}
        <span className='cart-container'>
          <FaShoppingCart />
          <span className='cart-value'>12</span>
        </span>
      </Link>
      <button type='button' className='auth-btn'>
        Login <FaUserPlus />
      </button>
    </Wrapper>
  );
};
```

- components/Navbar.js

```js
import { useProductsContext } from '../context/products_context';
import { useUserContext } from '../context/user_context';

const Nav = () => {
  const { openSidebar } = useProductsContext();
  return (
    <NavContainer>
      <div className='nav-center'>
        <div className='nav-header'>
          <Link to='/'>
            <img src={logo} alt='comfy sloth' />
          </Link>
          <button type='buttton' className='nav-toggle' onClick={openSidebar}>
            <FaBars />
          </button>
        </div>
        <ul className='nav-links'>
          {links.map((link) => {
            const { id, text, url } = link;
            return (
              <li key={id}>
                <Link to={url}>{text}</Link>
              </li>
            );
          })}
        </ul>
      </div>
    </NavContainer>
  );
};
```

## ERROR PAGE

- pages/ErrorPage.js

```js
import { Link } from 'react-router-dom';

const ErrorPage = () => {
  return (
    <Wrapper className='page-100'>
      <section>
        <h1>404</h1>
        <h3>Sorry, the page you tried cannot be found</h3>
        <Link to='/' className='btn'>
          back home
        </Link>
      </section>
    </Wrapper>
  );
};
```

## ABOUT PAGE AND CHECKOUT PAGE

- pages/AboutPage.js

```js
import { PageHero } from '../components';
import aboutImg from '../assets/hero-bcg.jpeg';

const AboutPage = () => {
  return (
    <main>
      <PageHero title='About' />
      <Wrapper className='page section section-center'>
        <img src={aboutImg} alt='nice desk' />
        <article>
          <div className='title'>
            <h2>our story</h2>
            <div className='underline'></div>
          </div>
          <p>
            Lorem ipsum dolor sit amet consectetur adipisicing elit. Eaque odio
            ipsa quam porro dolorem et nemo eos maxime quaerat ratione, error
            blanditiis saepe hic natus quibusdam, nostrum, quod neque
            doloremque?
          </p>
        </article>
      </Wrapper>
    </main>
  );
};
```

- components/PageHero.js

```js
import { Link } from 'react-router-dom';

const PageHero = ({ title }) => {
  return (
    <Wrapper>
      <div className='section-center'>
        <h3>
          <Link to='/'>Home</Link> / {title}
        </h3>
      </div>
    </Wrapper>
  );
};
```

- pages/CheckoutPage.js

```js
import { PageHero, StripeCheckout } from '../components';
// extra imports
import { useCartContext } from '../context/cart_context';
import { Link } from 'react-router-dom';

const CheckoutPage = () => {
  return (
    <main>
      <PageHero title='checkout' />
      <Wrapper className='page'>
        <h1>checkout here</h1>
      </Wrapper>
    </main>
  );
};
```

## HOME PAGE

- pages/HomePage.js

```js
import { FeaturedProducts, Hero, Services, Contact } from '../components';

const HomePage = () => {
  return (
    <main>
      <Hero />
      <FeaturedProducts />
      <Services />
      <Contact />
    </main>
  );
};
```

## HOME PAGE - SERVICES

- components/Services.js

```js
import { services } from '../utils/constants';

const Services = () => {
  return (
    <Wrapper>
      <div className='section-center'>
        <article className='header'>
          <h3>
            custom furniture <br />
            build only for you
          </h3>
          <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Molestias
            maxime adipisci odio voluptates, accusamus possimus. Odio ab
            mollitia corporis molestias.
          </p>
        </article>
        <div className='services-center'>
          {services.map((service) => {
            const { id, icon, title, text } = service;
            return (
              <article key={id} className='service'>
                <span className='icon'>{icon}</span>
                <h4>{title}</h4>
                <p>{text}</p>
              </article>
            );
          })}
        </div>
      </div>
    </Wrapper>
  );
};
```

## HOME PAGE - CONTACT - FORMSPREE

- components/Contact.js

```js
const Contact = () => {
  return (
    <Wrapper>
      <div className='section-center'>
        <h3>Join our newsletter and get 20% off</h3>
        <div className='content'>
          <p>
            Lorem ipsum dolor sit amet consectetur adipisicing elit. Laborum
            nisi esse cumque vitae, architecto molestias omnis. Odio provident
            vero rem earum. Magni aut placeat tempora distinctio earum et
            maxime. Sunt.
          </p>
          <form
            className='contact-form'
            action='https://formspree.io/f/xgedjjdk'
            method='POST'
          >
            <input
              type='email'
              className='form-input'
              placeholder='enter email'
              name='_replyto'
            />
            <button type='submit' className='submit-btn'>
              subscribe
            </button>
          </form>
        </div>
      </div>
    </Wrapper>
  );
};
```

## FETCH PRODUCTS

- context/products_context.js

```js
const initialState = {
  isSidebarOpen: false,
  products_loading: false,
  products_error: false,
  products: [],
  featured_products: [],
};

const ProductsContext = React.createContext();

export const ProductsProvider = ({ children }) => {
  const [state, dispatch] = useReducer(reducer, initialState);
  const openSidebar = () => {
    dispatch({ type: SIDEBAR_OPEN });
  };
  const closeSidebar = () => {
    dispatch({ type: SIDEBAR_CLOSE });
  };

  const fetchProducts = async (url) => {
    dispatch({ type: GET_PRODUCTS_BEGIN });
    try {
      const response = await axios.get(url);
      const products = await response.data;
      dispatch({ type: GET_PRODUCTS_SUCCESS, payload: products });
    } catch (error) {
      dispatch({ type: GET_PRODUCTS_ERROR });
      console.log(error);
    }
  };

  useEffect(() => {
    fetchProducts(url);
  }, []);
```

- reducers/products_reducer.js

```js
const products_reducer = (state, action) => {
  if (action.type === SIDEBAR_OPEN) {
    // console.log(state);
    return { ...state, isSidebarOpen: true };
  }

  if (action.type === SIDEBAR_CLOSE) {
    // console.log(state);
    return { ...state, isSidebarOpen: false };
  }

  if (action.type === GET_PRODUCTS_BEGIN) {
    return { ...state, products_loading: true };
  }

  if (action.type === GET_PRODUCTS_SUCCESS) {
    const featured_products = action.payload.filter((product) => {
      return product.featured === true;
    });
    return {
      ...state,
      products_loading: false,
      products: action.payload,
      featured_products: featured_products,
    };
  }

  if (action.type === GET_PRODUCTS_ERROR) {
    return { ...state, products_loading: true, error: true };
  }

  return state;

  throw new Error(`No Matching "${action.type}" - action type`);
};
```

## FEATURED PRODUCTS

- components/Loading.js

```js
import React from 'react';

const Loading = () => {
  return (
    <div className='section section-center'>
      <div className='loading'></div>
    </div>
  );
};

export default Loading;
```

- components/Error.js

```js
import React from 'react';

const Error = () => {
  return (
    <div className='section section-center text-center'>
      <h2>there was an error...</h2>
    </div>
  );
};

export default Error;
```

- components/FeaturedProducts.js

```js
const FeaturedProducts = () => {
  const {
    products_loading: loading,
    products_error: error,
    featured_products: featured,
  } = useProductsContext();

  if (loading) {
    return <Loading />;
  }
  if (error) {
    return <Error />;
  }
  return (
    <Wrapper className='section'>
      <div className='title'>
        <h2>featured products</h2>
        <div className='underline'></div>
      </div>
      <div className='section-center featured'>
        {featured.slice(0, 3).map((product) => {
          return <Product key={product.id} {...product} />;
        })}
      </div>
    </Wrapper>
  );
};
```

- components/Product.js

```js
const Product = ({ image, name, price, id }) => {
  return (
    <Wrapper>
      <div className='container'>
        <img src={image} alt={name} />
        <Link to={`/products/${id}`} className='link'>
          <FaSearch />
        </Link>
      </div>
      <footer>
        <h5>{name}</h5>
        <p>{price}</p>
      </footer>
    </Wrapper>
  );
};
```

## FORMAT PRICE - INTERNATIONAL FORMAT PRICE

- components/Product.js

```js
const Product = ({ image, name, price, id }) => {
  return (
    <Wrapper>
      <div className='container'>
        <img src={image} alt={name} />
        <Link to={`/products/${id}`} className='link'>
          <FaSearch />
        </Link>
      </div>
      <footer>
        <h5>{name}</h5>
        <p>{formatPrice(price)}</p>
      </footer>
    </Wrapper>
  );
};
```

- utils/helpers.js

```js
export const formatPrice = (number) => {
  return new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency: 'USD',
  }).format(number / 100);
};
```

## FETCH SINGLE PRODUCT

- context/products_context.js

```js
const initialState = {
  isSidebarOpen: false,
  products_loading: false,
  products_error: false,
  products: [],
  featured_products: [],
  single_product_loading: false,
  single_product_error: false,
  single_product: {},
};
```

```js
const fetchSingleProduct = async (url) => {
  dispatch({ type: GET_SINGLE_PRODUCT_BEGIN });
  try {
    const response = await axios.get(url);
    const singleProduct = response.data;
    dispatch({ type: GET_SINGLE_PRODUCT_SUCCESS, payload: singleProduct });
  } catch (error) {
    dispatch({ type: GET_SINGLE_PRODUCT_ERROR });
  }
};
```

- reducers/products_reducer.js

```js
/* SINGLE PRODUCT */
if (action.type === GET_SINGLE_PRODUCT_BEGIN) {
  return {
    ...state,
    single_product_loading: true,
    single_product_error: false,
  };
}
if (action.type === GET_SINGLE_PRODUCT_SUCCESS) {
  return {
    ...state,
    single_product_loading: false,
    single_product: action.payload,
  };
}
if (action.type === GET_SINGLE_PRODUCT_ERROR) {
  return {
    ...state,
    single_product_loading: false,
    single_product_error: true,
  };
}

// return state;
```

## SINGLE PRODUCT - LOADING ERROR

- context/products_context.js

```js
return (
  <ProductsContext.Provider
    value={{ ...state, openSidebar, closeSidebar, fetchSingleProduct }}
  >
    {children}
  </ProductsContext.Provider>
);
```

- pages/SingleProductPage.js

```js
const SingleProductPage = () => {
  // console.log(useParams());
  const { id } = useParams();
  const history = useHistory();
  const {
    single_product_loading: loading,
    single_product_error: error,
    single_product: product,
    fetchSingleProduct,
  } = useProductsContext();

  useEffect(() => {
    fetchSingleProduct(`${url}${id}`);
  }, [id]);
  // console.log(product);

  useEffect(() => {
    if (error) {
      setTimeout(() => {
        history.push('/');
      }, 3000);
    }
  }, [error]);

  if (loading) {
    return <Loading />;
  }
  if (error) {
    return <Error />;
  }

  return <h4>single product page</h4>;
};
```

## SINGLE PRODUCT - BASE RETURN

- pages/SingleProductPage.js

```js
const SingleProductPage = () => {
  // console.log(useParams());
  const { id } = useParams();
  const history = useHistory();
  const {
    single_product_loading: loading,
    single_product_error: error,
    single_product: product,
    fetchSingleProduct,
  } = useProductsContext();

  useEffect(() => {
    fetchSingleProduct(`${url}${id}`);
  }, [id]);
  // console.log(product);

  useEffect(() => {
    if (error) {
      setTimeout(() => {
        history.push('/');
      }, 3000);
    }
  }, [error]);

  if (loading) {
    return <Loading />;
  }
  if (error) {
    return <Error />;
  }

  console.log(product);
  const {
    name,
    price,
    description,
    stock,
    stars,
    reviews,
    id: sku,
    company,
    images,
  } = product;

  return (
    <Wrapper>
      <PageHero title={name} product />
      <div className='section section-center page'>
        <Link to='/products' className='btn'>
          back to products
        </Link>
        <div className='product-center'>
          <ProductImages images={images} />
          <section className='content'>
            <h2>{name}</h2>
            <Stars />
            <h5 className='price'>{formatPrice(price)}</h5>
            <p className='desc'>{description}</p>
            <p className='info'>
              <span>Available : </span>
              {stock > 0 ? 'In stock' : 'Out of stock'}
            </p>
            <p className='info'>
              <span>SKU : </span>
              {sku}
            </p>
            <p className='info'>
              <span>Brand : </span>
              {company}
            </p>
            <hr />
            {stock > 0 && <AddToCart />}
          </section>
        </div>
      </div>
    </Wrapper>
  );
};
```

- components/PageHero.js

```js
const PageHero = ({ title, product }) => {
  return (
    <Wrapper>
      <div className='section-center'>
        <h3>
          <Link to='/'>Home</Link> /{' '}
          {product && <Link to='/products'>Products /</Link>} {title}
        </h3>
      </div>
    </Wrapper>
  );
};
```

## SINGLE PRODUCT - PRODUCT IMAGES

- components/ProductImages.js

```js
const ProductImages = ({ images = [{ url: '' }] }) => {
  const [main, setMain] = useState(images[0]);
  console.log(main);

  return (
    <Wrapper>
      <img src={main.url} alt='main image' className='main' />
      <div className='gallery'>
        {images.map((image, index) => {
          return (
            <img
              src={image.url}
              alt={image.filename}
              key={index}
              onClick={() => setMain(images[index])}
              className={`${image.url === main.url ? 'active' : null}`}
            />
          );
        })}
      </div>
    </Wrapper>
  );
};
```

## SINGLE PRODUCT - STARS

- pages/SingleProductPage.js

```js
<Stars stars={stars} reviews={reviews} />
```

- components/Sttars.js

```js
const Stars = ({ stars, reviews }) => {
  // console.log(stars, reviews);
  return (
    <Wrapper>
      <div className='stars'>
        {/* star */}
        <span>
          {stars >= 1 ? (
            <BsStarFill />
          ) : stars >= 0.5 ? (
            <BsStarHalf />
          ) : (
            <BsStar />
          )}
        </span>
        {/* end of star */}
        {/* star */}
        <span>
          {stars >= 2 ? (
            <BsStarFill />
          ) : stars >= 1.5 ? (
            <BsStarHalf />
          ) : (
            <BsStar />
          )}
        </span>
        {/* end of star */}
        {/* star */}
        <span>
          {stars >= 3 ? (
            <BsStarFill />
          ) : stars >= 2.5 ? (
            <BsStarHalf />
          ) : (
            <BsStar />
          )}
        </span>
        {/* end of star */}
        {/* star */}
        <span>
          {stars >= 4 ? (
            <BsStarFill />
          ) : stars >= 3.5 ? (
            <BsStarHalf />
          ) : (
            <BsStar />
          )}
        </span>
        {/* end of star */}
        {/* star */}
        <span>
          {stars == 5 ? (
            <BsStarFill />
          ) : stars >= 4.5 ? (
            <BsStarHalf />
          ) : (
            <BsStar />
          )}
        </span>
        {/* end of star */}
      </div>
      <p className='reviews'>({reviews} customer reviews)</p>
    </Wrapper>
  );
};
```

## SINGLE PRODUCT - STARS ARRAY APPROACH

- components/Stars.js

```js
const Stars = ({ stars, reviews }) => {
  const tempStars = Array.from({ length: 5 }, (_, index) => {
    // index 0 - 4
    // console.log(index);
    const number = index + 0.5;

    return (
      <span key={index}>
        {stars >= index + 1 ? (
          <BsStarFill />
        ) : stars >= number ? (
          <BsStarHalf />
        ) : (
          <BsStar />
        )}
      </span>
    );
  });

  return (
    <Wrapper>
      <div className='stars'>{tempStars}</div>
      <p className='reviews'>({reviews} customer reviews)</p>
    </Wrapper>
  );
};
```

## SINGLE PRODUCT - ADD TO CART, COLORS

- pages/SingleProductPage.js

```js
{
  stock > 0 && <AddToCart product={product} />;
}
```

- components/AddToCart.js

```js
const AddToCart = ({ product }) => {
  const { id, stock, colors } = product;
  // console.log(colors);
  const [mainColor, setMainColor] = useState(colors[0]);

  return (
    <Wrapper>
      <div className='colors'>
        <span>colors : </span>
        <div>
          {colors.map((color, index) => {
            return (
              <button
                key={index}
                style={{ background: color }}
                className={`${
                  mainColor === color ? 'color-btn active' : 'color-btn'
                }`}
                onClick={() => setMainColor(color)}
              >
                {mainColor === color ? <FaCheck /> : null}
              </button>
            );
          })}
        </div>
        <div className='btn-container'></div>
      </div>
    </Wrapper>
  );
};
```

## SINGLE PRODUCT - ADD TO CART - AMOUNT BUTTON

- pages/SingleProductPage.js

```js
{
  stock > 0 && <AddToCart product={product} />;
}
```

- components/AddToCart.js

```js
const [amount, setAmount] = useState(1);

const increase = () => {
  setAmount((oldAmount) => {
    let tempAmount = oldAmount + 1;
    if (tempAmount > stock) {
      tempAmount = stock;
    }
    return tempAmount;
  });
};

const decrease = () => {
  setAmount((oldAmount) => {
    let tempAmount = oldAmount - 1;
    if (tempAmount < 1) {
      tempAmount = 1;
    }
    return tempAmount;
  });
};
```

```js
<div className='btn-container'>
  <AmountButtons amount={amount} increase={increase} decrease={decrease} />
  <Link to='/cart' className='btn'>
    Add to cart
  </Link>
</div>
```

- components/AmountButtons.js

```js
import { FaPlus, FaMinus } from 'react-icons/fa';

const AmountButtons = ({ amount, increase, decrease }) => {
  return (
    <Wrapper className='amount-btns'>
      <button type='button' className='amount-btn' onClick={decrease}>
        <FaMinus />
      </button>
      <h2 className='amount'>{amount}</h2>
      <button type='button' className='amount-btn' onClick={increase}>
        <FaPlus />
      </button>
    </Wrapper>
  );
};
```

## FILTER CONTEXT SETUP

- index.js

```js
ReactDOM.render(
  <ProductsProvider>
    <FilterProvider>
      <App />
    </FilterProvider>
  </ProductsProvider>,
  document.getElementById('root')
);
```

- context/filter_context.js

```js
import React, { useEffect, useContext, useReducer } from 'react';
import reducer from '../reducers/filter_reducer';
import {
  LOAD_PRODUCTS,
  SET_GRIDVIEW,
  SET_LISTVIEW,
  UPDATE_SORT,
  SORT_PRODUCTS,
  UPDATE_FILTERS,
  FILTER_PRODUCTS,
  CLEAR_FILTERS,
} from '../actions';
import { useProductsContext } from './products_context';

const initialState = {
  filtered_products: [],
  all_products: [],
};

const FilterContext = React.createContext();

export const FilterProvider = ({ children }) => {
  const { products } = useProductsContext();
  const [state, dispatch] = useReducer(reducer, initialState);

  useEffect(() => {
    dispatch({ type: LOAD_PRODUCTS, payload: products });
  }, [products]);

  return (
    <FilterContext.Provider value='filter context'>
      {children}
    </FilterContext.Provider>
  );
};
// make sure use
export const useFilterContext = () => {
  return useContext(FilterContext);
};
```

- reducers/filter_reducer.js

```js
import {
  LOAD_PRODUCTS,
  SET_LISTVIEW,
  SET_GRIDVIEW,
  UPDATE_SORT,
  SORT_PRODUCTS,
  UPDATE_FILTERS,
  FILTER_PRODUCTS,
  CLEAR_FILTERS,
} from '../actions';

const filter_reducer = (state, action) => {
  if (action.type === LOAD_PRODUCTS) {
    return {
      ...state,
      all_products: [...action.payload],
      filtered_products: [...action.payload],
    };
  }
  // return state;

  throw new Error(`No Matching "${action.type}" - action type`);
};

export default filter_reducer;
```

## PRODUCTS PAGE - GRID VIEW

- pages/ProductsPage.js

```js
import { Filters, ProductList, Sort, PageHero } from '../components';

const ProductsPage = () => {
  return (
    <main>
      <PageHero title='products' />
      <Wrapper className='page'>
        <div className='section-center products'>
          <Filters />
          <div>
            <Sort />
            <ProductList />
          </div>
        </div>
      </Wrapper>
    </main>
  );
};
```

- context/filter_context.js

```js
<FilterContext.Provider value={{ ...state }}>{children}</FilterContext.Provider>
```

- components/ProductList.js

```js
import { useFilterContext } from '../context/filter_context';
import GridView from './GridView';
import ListView from './ListView';

const ProductList = () => {
  const { filtered_products: products } = useFilterContext();

  return <GridView products={products}>product list</GridView>;
};

export default ProductList;
```

- components/GridView.js

```js
import { useFilterContext } from '../context/filter_context';
import GridView from './GridView';
import ListView from './ListView';

const ProductList = () => {
  const { filtered_products: products } = useFilterContext();

  return <GridView products={products}>product list</GridView>;
};

export default ProductList;
```

## PRODUCTS PAGE - LIST VIEW

- context/filter_context.js

```js
const initialState = {
  filtered_products: [],
  all_products: [],
  grid_view: false,
};
```

- components/ProductList.js

```js
const ProductList = () => {
  const { filtered_products: products, grid_view } = useFilterContext();
  if (products.length < 1) {
    return (
      <h5 style={{ texTransform: 'none' }}>
        Sorry, no products matched your search...
      </h5>
    );
  }
  if (grid_view === false) {
    return <ListView products={products}>Product list</ListView>;
  }

  return <GridView products={products}>product list</GridView>;
};
```

- components/ListView.js

```js
const ListView = ({ products }) => {
  return (
    <Wrapper>
      {products.map((product) => {
        const { id, image, name, price, description } = product;

        return (
          <article key={id}>
            <img src={image} alt={name} />
            <div>
              <h4>{name}</h4>
              <h5 className='price'>{formatPrice(price)}</h5>
              <p>{description.substring(0, 150)}...</p>
              <Link to={`/products/${id}`} className='btn'>
                Details
              </Link>
            </div>
          </article>
        );
      })}
    </Wrapper>
  );
};
```

- context/filter_context.js

```js
const initialState = {
  filtered_products: [],
  all_products: [],
  grid_view: true,
};
```

## SORT COMPONENT - BASIC SETUP

- components/Sort.js

```js
const Sort = () => {
  const { filtered_products: products, grid_view } = useFilterContext();

  return (
    <Wrapper>
      <div className='btn-container'>
        <button type='button' className={`${grid_view ? 'active' : null}`}>
          <BsFillGridFill />
        </button>
        <button type='button' className={`${!grid_view ? 'active' : null}`}>
          <BsList />
        </button>
      </div>
      <p>{products.length} products found</p>
      <hr />
      <form>
        <label htmlFor='sort'>sort by</label>
        <select name='sort' id='sort' className='sort-input'>
          <option value='price-lowest'>price (lowest)</option>
          <option value='price-highest'>price (highest)</option>
          <option value='name-a'>name (a-z)</option>
          <option value='name-z'>name (z-a)</option>
        </select>
      </form>
    </Wrapper>
  );
};
```

## SORT COMPONENT - VIEW BUTTONS

- components/Sort.js

```js
const setGridView = () => {
  dispatch({ type: SET_GRIDVIEW });
};

const setListView = () => {
  dispatch({ type: SET_LISTVIEW });
};

return (
  <FilterContext.Provider value={{ ...state, setGridView, setListView }}>
    {children}
  </FilterContext.Provider>
);
```

- components/Sort.js

```js
const Sort = () => {
  const {
    filtered_products: products,
    grid_view,
    setGridView,
    setListView,
  } = useFilterContext();

  return (
    <Wrapper>
      <div className='btn-container'>
        <button
          type='button'
          className={`${grid_view ? 'active' : null}`}
          onClick={setGridView}
        >
          <BsFillGridFill />
        </button>
        <button
          type='button'
          className={`${!grid_view ? 'active' : null}`}
          onClick={setListView}
        >
          <BsList />
        </button>
      </div>
      <p>{products.length} products found</p>
      <hr />
      <form>
        <label htmlFor='sort'>sort by</label>
        <select name='sort' id='sort' className='sort-input'>
          <option value='price-lowest'>price (lowest)</option>
          <option value='price-highest'>price (highest)</option>
          <option value='name-a'>name (a-z)</option>
          <option value='name-z'>name (z-a)</option>
        </select>
      </form>
    </Wrapper>
  );
};
```

- reducers/filter_reducer.js

```js
const filter_reducer = (state, action) => {
  /* LOAD */
  if (action.type === LOAD_PRODUCTS) {
    return {
      ...state,
      all_products: [...action.payload],
      filtered_products: [...action.payload],
    };
  }
  /* VIEW */
  if (action.type === SET_GRIDVIEW) {
    return { ...state, grid_view: true };
  }
  if (action.type === SET_LISTVIEW) {
    return { ...state, grid_view: false };
  }

  throw new Error(`No Matching "${action.type}" - action type`);
};
```

## SORT COMPONENTS - CONTROLLED INPUT

- context/filter_context.js

```js
const initialState = {
  filtered_products: [],
  all_products: [],
  grid_view: true,
  sort: 'price-lowest',
};

const FilterContext = React.createContext();

export const FilterProvider = ({ children }) => {
  const { products } = useProductsContext();
  const [state, dispatch] = useReducer(reducer, initialState);

  useEffect(() => {
    dispatch({ type: LOAD_PRODUCTS, payload: products });
  }, [products]);

  const setGridView = () => {
    dispatch({ type: SET_GRIDVIEW });
  };

  const setListView = () => {
    dispatch({ type: SET_LISTVIEW });
  };

  const updateSort = (e) => {
    // for demonstration
    // const name = e.target.name;
    const value = e.target.value;
    // console.log(name, value);
    dispatch({ type: UPDATE_SORT, payload: value });
  };

  return (
    <FilterContext.Provider
      value={{ ...state, setGridView, setListView, updateSort }}
    >
      {children}
    </FilterContext.Provider>
  );
};
```

- components/Sort.js

```js
const Sort = () => {
  const {
    filtered_products: products,
    grid_view,
    setGridView,
    setListView,
    sort,
    updateSort,
  } = useFilterContext();

  return (
    <Wrapper>
      <div className='btn-container'>
        <button
          type='button'
          className={`${grid_view ? 'active' : null}`}
          onClick={setGridView}
        >
          <BsFillGridFill />
        </button>
        <button
          type='button'
          className={`${!grid_view ? 'active' : null}`}
          onClick={setListView}
        >
          <BsList />
        </button>
      </div>
      <p>{products.length} products found</p>
      <hr />
      <form>
        <label htmlFor='sort'>sort by</label>
        <select
          name='sort'
          id='sort'
          className='sort-input'
          value={sort}
          onChange={updateSort}
        >
          <option value='price-lowest'>price (lowest)</option>
          <option value='price-highest'>price (highest)</option>
          <option value='name-a'>name (a-z)</option>
          <option value='name-z'>name (z-a)</option>
        </select>
      </form>
    </Wrapper>
  );
};
```

- reducers/filter_reducer.js

```js
/* UPDATE SORT */
if (action.type === UPDATE_SORT) {
  return { ...state, sort: action.payload };
}
```

## SORT COMPONENTS - SORT FUNCTIONALITY

- context/filter_context.js

```js
useEffect(() => {
  dispatch({ type: SORT_PRODUCTS });
}, [products, state.sort]);
```

- context/filter_reducer.js

```js
/* SORT */
if (action.type === UPDATE_SORT) {
  return { ...state, sort: action.payload };
}
if (action.type === SORT_PRODUCTS) {
  const { sort, filtered_products } = state;
  let tempProducts = [...filtered_products];
  if (sort === 'price-lowest') {
    // console.log('price-lowest');
    // tempProducts = tempProducts.sort((a, b) => a.price - b.price);
    tempProducts = tempProducts.sort((a, b) => {
      if (a.price < b.price) {
        return -1;
      }
      if (a.price > b.price) {
        return 1;
      }
      return 0;
    });
  }
  if (sort === 'price-highest') {
    // console.log('price-highest');
    tempProducts = tempProducts.sort((a, b) => b.price - a.price);
  }
  if (sort === 'name-a') {
    // console.log('name-a');
    tempProducts = tempProducts.sort((a, b) => {
      return a.name.localeCompare(b.name);
    });
  }
  if (sort === 'name-z') {
    // console.log('name-z');
    tempProducts = tempProducts.sort((a, b) => {
      return b.name.localeCompare(a.name);
    });
  }
  return { ...state, filtered_products: tempProducts };
}
```

## FILTERS - DEFAULT VALUES

- context/filter_context.js

```js
const initialState = {
  filtered_products: [],
  all_products: [],
  grid_view: true,
  sort: 'price-lowest',
  filters: {
    text: '',
    company: 'all',
    category: 'all',
    color: 'all',
    min_price: 0,
    max_price: 0,
    price: 0,
    shipping: false,
  },
};
```

- reducers/filter_reducer.js

```js
/* LOAD */
if (action.type === LOAD_PRODUCTS) {
  let maxPrice = action.payload.map((p) => p.price);
  maxPrice = Math.max(...maxPrice);
  console.log(maxPrice);
  return {
    ...state,
    all_products: [...action.payload],
    filtered_products: [...action.payload],
    filters: { ...state.filters, max_price: maxPrice, price: maxPrice },
  };
}
```

## FILTERS - TEXT

- components/Filter.js

```js
const Filters = () => {
  const {
    filters: { text, category, company, color, min_price, max_price, shipping },
    updateFilters,
    clearFilters,
    all_products,
  } = useFilterContext();
  return (
    <Wrapper>
      <div className='content'>
        <form onSubmit={(e) => e.preventDefault()}>
          {/* search input */}
          <div className='form-control'>
            <input
              type='text'
              name='text'
              placeholder='search'
              className='search-input'
              value={text}
              onChange={updateFilters}
            />
          </div>
          {/* end search input */}
        </form>
      </div>
    </Wrapper>
  );
};
```

- context/filter_context.js

```js
const initialState = {
  filtered_products: [],
  all_products: [],
  grid_view: true,
  sort: 'price-lowest',
  filters: {
    text: '',
    company: 'all',
    category: 'all',
    color: 'all',
    min_price: 0,
    max_price: 0,
    price: 0,
    shipping: false,
  },
};

const FilterContext = React.createContext();

export const FilterProvider = ({ children }) => {
  const { products } = useProductsContext();
  const [state, dispatch] = useReducer(reducer, initialState);

  useEffect(() => {
    dispatch({ type: LOAD_PRODUCTS, payload: products });
  }, [products]);

  useEffect(() => {
    dispatch({ type: FILTER_PRODUCTS });
    dispatch({ type: SORT_PRODUCTS });
  }, [products, state.sort, state.filters]);

  const setGridView = () => {
    dispatch({ type: SET_GRIDVIEW });
  };

  const setListView = () => {
    dispatch({ type: SET_LISTVIEW });
  };

  const updateSort = (e) => {
    const value = e.target.value;
    dispatch({ type: UPDATE_SORT, payload: value });
  };

  const updateFilters = (e) => {
    let name = e.target.name;
    let value = e.target.value;
    // console.log(name, value);
    dispatch({ type: UPDATE_FILTERS, payload: { name, value } });
  };

  const clearFilters = () => {};

  return (
    <FilterContext.Provider
      value={{
        ...state,
        setGridView,
        setListView,
        updateSort,
        updateFilters,
        clearFilters,
      }}
    >
      {children}
    </FilterContext.Provider>
  );
};
```

- reducers/filter_reducer.js

```js
/* FILTER */
if (action.type === UPDATE_FILTERS) {
  const { name, value } = action.payload;
  return { ...state, filters: { ...state.filters, [name]: value } };
}
if (action.type === FILTER_PRODUCTS) {
  console.log('filtering products...');
  return { ...state };
}
```

## FILTER - UNIQUE VALUES

- components/Filters.js

```js
const Filters = () => {
  const {
    filters: { text, category, company, color, min_price, max_price, shipping },
    updateFilters,
    clearFilters,
    all_products,
  } = useFilterContext();

  const categories = getUniqueValues(all_products, 'category');
  const companies = getUniqueValues(all_products, 'company');
  const colors = getUniqueValues(all_products, 'colors');
  console.log(categories);

  return (
    <Wrapper>
      <div className='content'>
        <form onSubmit={(e) => e.preventDefault()}>
          {/* search input */}
          <div className='form-control'>
            <input
              type='text'
              name='text'
              placeholder='search'
              className='search-input'
              value={text}
              onChange={updateFilters}
            />
          </div>
          {/* end search input */}
        </form>
      </div>
    </Wrapper>
  );
};
```

- utils/helpers.js

```js
export const formatPrice = (number) => {
  return new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency: 'USD',
  }).format(number / 100);
};

export const getUniqueValues = (data, type) => {
  let unique = data.map((item) => item[type]);
  // console.log(unique);
  if (type === 'colors') {
    unique = unique.flat();
  }
  return ['all', ...new Set(unique)];
};
```

## FILTERS - CATEGORIES

- components/Filters.js

```js
{
  /* categories */
}
<div className='form-control'>
  <h5>category</h5>
  <div>
    {categories.map((singleCategory, index) => {
      return (
        <button
          key={index}
          onClick={updateFilters}
          type='button'
          name='category'
          className={`${
            category === singleCategory.toLowerCase() ? 'active' : null
          }`}
        >
          {singleCategory}
        </button>
      );
    })}
  </div>
</div>;
{
  /* end of categories */
}
```

- context/filter_context.js

```js
const updateFilters = (e) => {
  let name = e.target.name;
  let value = e.target.value;
  if (name === 'category') {
    value = e.target.textContent;
  }
  dispatch({ type: UPDATE_FILTERS, payload: { name, value } });
};
```

## FILTERS - COMPANIES

- components/Filters.js

```js
{
  /* companies */
}
<div className='form-control'>
  <h5>company</h5>
  <select
    name='company'
    value={company}
    onChange={updateFilters}
    className='company'
  >
    {companies.map((singleCompany, index) => {
      return (
        <option key={index} value={singleCompany}>
          {singleCompany}
        </option>
      );
    })}
  </select>
</div>;
{
  /* end of companies */
}
```

## FILTER - COLORS

- components/Filter.js

```js
{
  /* colors */
}
<div className='form-control'>
  <h5>colors</h5>
  <div className='colors'>
    {colors.map((singleColor, index) => {
      return (
        <button
          key={index}
          name='color'
          style={{ background: singleColor }}
          className={`${
            color === singleColor ? 'color-btn active' : 'color-btn'
          }`}
          data-color={singleColor}
          onClick={updateFilters}
        >
          {color === singleColor ? <FaCheck /> : null}
        </button>
      );
    })}
  </div>
</div>;
{
  /* end of colors */
}
```

- context/filter_context.js

```js
const updateFilters = (e) => {
  let name = e.target.name;
  let value = e.target.value;
  if (name === 'category') {
    value = e.target.textContent;
  }
  if (name === 'color') {
    value = e.target.dataset.color;
  }
  dispatch({ type: UPDATE_FILTERS, payload: { name, value } });
};
```

- components/Filter.js

```js
{
  /* colors */
}
<div className='form-control'>
  <h5>colors</h5>
  <div className='colors'>
    {colors.map((singleColor, index) => {
      if (singleColor === 'all') {
        return (
          <button
            key={index}
            name='color'
            onClick={updateFilters}
            data-color='all'
            className={`${color === 'all' ? 'all-btn active' : 'all-btn'}`}
          >
            all
          </button>
        );
      }
      return (
        <button
          key={index}
          name='color'
          style={{ background: singleColor }}
          className={`${
            color === singleColor ? 'color-btn active' : 'color-btn'
          }`}
          data-color={singleColor}
          onClick={updateFilters}
        >
          {color === singleColor ? <FaCheck /> : null}
        </button>
      );
    })}
  </div>
</div>;
{
  /* end of colors */
}
```

## FILTERS - PRICE

- components/Filter.js

```js
{
  /* price */
}
<div className='form-control'>
  <h5>price</h5>
  <p className='price'>{formatPrice(price)}</p>
  <input
    type='range'
    name='price'
    onChange={updateFilters}
    min={min_price}
    max={max_price}
    value={price}
  />
</div>;
{
  /* end of price */
}
```

- context/filter_context.js

```js
const updateFilters = (e) => {
  let name = e.target.name;
  let value = e.target.value;
  if (name === 'category') {
    value = e.target.textContent;
  }
  if (name === 'color') {
    value = e.target.dataset.color;
  }
  if (name === 'price') {
    value = Number(value);
  }
  // console.log(name, value);
  dispatch({ type: UPDATE_FILTERS, payload: { name, value } });
};
```

## FILTERS - SHIPPING CHECKBOX, CLEAR FILTERS

- components/Filters.js

```js
{
  /* shipping */
}
<div className='form-control shipping'>
  <label htmlFor='shipping'>free shipping</label>
  <input
    type='checkbox'
    name='shipping'
    id='shipping'
    onChange={updateFilters}
    checked={shipping}
  />
</div>;
{
  /* end of shipping */
}
```

- context/filter_context.js

```js
const updateFilters = (e) => {
  let name = e.target.name;
  let value = e.target.value;
  if (name === 'category') {
    value = e.target.textContent;
  }
  if (name === 'color') {
    value = e.target.dataset.color;
  }
  if (name === 'price') {
    value = Number(value);
  }
  if (name === 'shipping') {
    value = e.target.checked;
  }
  // console.log(name, value);
  dispatch({ type: UPDATE_FILTERS, payload: { name, value } });
};
```

- components/Filter.js

```js
<form>
/* ... */
</form>
<button type='button' className='clear-btn' onClick={clearFilters}>
  {' '}
  clear filters
</button>
```

- context/filter_context.js

```js
const clearFilters = () => {
  dispatch({ type: CLEAR_FILTERS });
};
```

- reducers/filter_reducer.js

```js
/* CLEAR FILTERS */
if (action.type === CLEAR_FILTERS) {
  return {
    ...state,
    filters: {
      ...state.filters,
      text: '',
      company: 'all',
      category: 'all',
      color: 'all',
      price: state.filters.max_price,
      shipping: false,
    },
  };
}
```

## FILTER FUNCTIONALITY - SETUP AND TEXT FILTER

- reducers/filter_reducer.js

```js
/* FILTER */
if (action.type === UPDATE_FILTERS) {
  const { name, value } = action.payload;
  return { ...state, filters: { ...state.filters, [name]: value } };
}
if (action.type === FILTER_PRODUCTS) {
  // console.log('filtering products...');
  const { all_products } = state;
  const { text, category, company, color, price, shipping } = state.filters;
  let tempProducts = [...all_products];
  // filtering
  if (text) {
    tempProducts = tempProducts.filter((product) => {
      return product.name.toLowerCase().startsWith(text);
    });
  }
  return { ...state, filtered_products: tempProducts };
}
```

## FILTER FUNCTIONALITY - REST OF THE FILTERS

- reducers/filter_reducer.js

```js
if (action.type === FILTER_PRODUCTS) {
  // console.log('filtering products...');
  const { all_products } = state;
  const { text, category, company, color, price, shipping } = state.filters;
  let tempProducts = [...all_products];
  // filtering
  // text
  if (text) {
    tempProducts = tempProducts.filter((product) => {
      return product.name.toLowerCase().startsWith(text);
    });
  }
  // category
  if (category !== 'all') {
    tempProducts = tempProducts.filter((product) => {
      return product.category === category;
    });
  }
  // company
  if (company !== 'all') {
    tempProducts = tempProducts.filter((product) => {
      return product.company === company;
    });
  }
  // colors
  if (color !== 'all') {
    tempProducts = tempProducts.filter((product) => {
      return product.colors.find((singleColor) => singleColor === color);
    });
  }
  // price
  tempProducts = tempProducts.filter((product) => product.price <= price);
  // shipping
  if (shipping) {
    tempProducts = tempProducts.filter((product) => product.shipping === true);
  }
  return { ...state, filtered_products: tempProducts };
}
```

## CART CONTEXT SETUP

- context/cart_context.js

```js
const initialState = {
  cart: [],
  total_items: 0,
  total_amount: 0,
  shipping_fee: 534,
};

const CartContext = React.createContext();

export const CartProvider = ({ children }) => {
  const [state, dispatch] = useReducer(reducer, initialState);

  return (
    <CartContext.Provider value='cart context'>{children}</CartContext.Provider>
  );
};
```

- index.js

```js
import { ProductsProvider } from './context/products_context';
import { FilterProvider } from './context/filter_context';
import { CartProvider } from './context/cart_context';
import { UserProvider } from './context/user_context';
import { Auth0Provider } from '@auth0/auth0-react';

ReactDOM.render(
  <ProductsProvider>
    <FilterProvider>
      <CartProvider>
        <App />
      </CartProvider>
    </FilterProvider>
  </ProductsProvider>,
  document.getElementById('root')
);
```

## ADDTOCART - SETUP

- context/cart_context.js

```js
export const CartProvider = ({ children }) => {
  const [state, dispatch] = useReducer(reducer, initialState);
  // add to cart
  const addToCart = (id, color, amount, product) => {
    dispatch({ type: ADD_TO_CART, payload: { id, color, amount, product } });
  };

  return (
    <CartContext.Provider value={{ ...state, addToCart }}>
      {children}
    </CartContext.Provider>
  );
};
```

- components/AddToCart.js

```js
const { addToCart } = useCartContext();
const { id, stock, colors } = product;
const [mainColor, setMainColor] = useState(colors[0]);
const [amount, setAmount] = useState(1);
```

```js
<Link
  to='/cart'
  className='btn'
  onClick={() => addToCart(id, mainColor, amount, product)}
>
  Add to cart
</Link>
```

## ADDTOCART REDUCER - NEW ITEM

- reducers/cart_creducer.js

```js
const cart_reducer = (state, action) => {
  if (action.type === ADD_TO_CART) {
    const { id, color, amount, product } = action.payload;
    const tempItem = state.cart.find((item) => item.id === id + color);
    if (tempItem) {
      // TODO
    } else {
      const newItem = {
        id: id + color,
        name: product.name,
        color,
        amount,
        image: product.images[0].url,
        price: product.price,
        max: product.stock,
      };
      return { ...state, cart: [...state.cart, newItem] };
    }
  }
  return state;
  throw new Error(`No Matching "${action.type}" - action type`);
};
```

## ADDTOCART REDUCER - EXISTING ITEM

- reducers/cart_reducer.js

```js
const cart_reducer = (state, action) => {
  if (action.type === ADD_TO_CART) {
    const { id, color, amount, product } = action.payload;
    const tempItem = state.cart.find((item) => item.id === id + color);
    if (tempItem) {
      const tempCart = state.cart.map((cartItem) => {
        if (cartItem.id === id + color) {
          let newAmount = cartItem.amount + amount;
          if (newAmount > cartItem.max) {
            newAmount = cartItem.max;
          }
          return { ...cartItem, amount: newAmount };
        } else {
          return cartItem;
        }
      });
      return { ...state, cart: tempCart };
    } else {
      const newItem = {
        id: id + color,
        name: product.name,
        color,
        amount,
        image: product.images[0].url,
        price: product.price,
        max: product.stock,
      };
      return { ...state, cart: [...state.cart, newItem] };
    }
  }
  // return state;
  throw new Error(`No Matching "${action.type}" - action type`);
};
```

## CART PAGE SETUP

- context/cart_context.js

```js
export const CartProvider = ({ children }) => {
  const [state, dispatch] = useReducer(reducer, initialState);
  // add to cart
  const addToCart = (id, color, amount, product) => {
    dispatch({ type: ADD_TO_CART, payload: { id, color, amount, product } });
  };
  // remove item
  const removeItem = (id) => {};
  // toggle amount
  const toggleAmount = (id, value) => {};
  // clear cart
  const clearCart = () => {};

  return (
    <CartContext.Provider
      value={{ ...state, addToCart, removeItem, toggleAmount, clearCart }}
    >
      {children}
    </CartContext.Provider>
  );
};
```

- pages/CartPage.js

```js
const CartPage = () => {
  const { cart } = useCartContext();
  if (cart.length < 1) {
    return (
      <Wrapper className='page-100'>
        <div className='empty'>
          <h2>Your cart is empty</h2>
          <Link to='/products' className='btn'>
            fill it
          </Link>
        </div>
      </Wrapper>
    );
  }
  return (
    <main>
      <PageHero title='cart' />
      <Wrapper className='page'>
        <CartContent />
      </Wrapper>
    </main>
  );
};
```

## LOCALSTORAGE

- context/cart_context.js

```js
const getLocalStorage = () => {
  let cart = localStorage.getItem('cart');
  if (cart) {
    return JSON.parse(localStorage.getItem('cart'));
  } else return [];
};

const initialState = {
  cart: getLocalStorage,
  total_items: 0,
  total_amount: 0,
  shipping_fee: 534,
};
```

```js
useEffect(() => {
  localStorage.setItem('cart', JSON.stringify(state.cart));
}, [state.cart]);

return (
  <CartContext.Provider
    value={{ ...state, addToCart, removeItem, toggleAmount, clearCart }}
  >
    {children}
  </CartContext.Provider>
);
```

## CART CONTENT

- components/CartContent.js

```js

```
